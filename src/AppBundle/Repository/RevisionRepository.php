<?php

namespace AppBundle\Repository;

use AppBundle\Libs\Normalizer\ResultDecorator;
use AppBundle\Libs\Repository\BaseRepository;
use Doctrine\ORM\EntityRepository;

/**
 * RevisionsRepository
 *
 * @author Yosviel Dominguez <yosvield@gmail.com>
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class RevisionRepository extends BaseRepository {

    public function getBaseQuery($baseEntity, $start = 0, $limit = 30, $filters = array(), $columnsAlias = array(), $decorator = ResultDecorator::DEFAULT_DECORATOR) {

    }

    /**
     * @author Yosviel Dominguez <yosvield@gmail.com>
     * @param $idpermit
     * @return array
     */
    public function getByPermit($idpermit){
        $qb = $this->createQueryBuilder('revision')
            ->innerJoin('revision.permitRevisions', 'permitRevisions')
            ->innerJoin('permitRevisions.permit', 'permit')
            ->andWhere("permit.id = (:idpermit)")
            ->setParameter('idpermit', $idpermit);

        return $qb->getQuery()->getResult();
    }
}
